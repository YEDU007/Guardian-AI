<script type="module">
  import { auth } from "./firebase/firebase-config.js";
import { signOut } 
  from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

window.logout = function(){
  signOut(auth).then(()=>{
    window.location = "index.html";
  });
}

  import { auth, db } from "./firebase/firebase-config.js";
  import { onAuthStateChanged, signOut } 
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import { collection, query, orderBy, onSnapshot } 
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  // Only allow logged-in users
  onAuthStateChanged(auth, (user) => {
    if (!user) {
      window.location = "index.html";
    } else {
      loadAlerts(user.uid);
    }
  });

  // Real-time alerts from Firestore
  function loadAlerts(userId) {
    const alertArea = document.getElementById("alertArea");
    alertArea.innerHTML = "Loading alerts...";

    const alertsRef = collection(db, "alerts");
    const alertQuery = query(alertsRef, orderBy("time", "desc")); // newest first

    onSnapshot(alertQuery, (snapshot) => {
      if (snapshot.empty) {
        alertArea.innerHTML = "No alerts yet üö´";
        return;
      }

      alertArea.innerHTML = ""; // clear old entries

      snapshot.forEach((doc) => {
        const alert = doc.data();
        const div = document.createElement("div");
        div.textContent = `‚ö†Ô∏è ${alert.message} ‚Äî ${alert.time}`;
        div.style.margin = "10px 0";
        div.style.padding = "8px";
        div.style.border = "1px solid #ccc";
        div.style.borderRadius = "8px";
        div.style.background = "#ffeaea";
        alertArea.appendChild(div);
      });
    });
  }

  // Back navigation
  function goBack() {
    window.location = "dashboard.html";
  }
</script>
